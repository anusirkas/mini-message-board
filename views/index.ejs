<!DOCTYPE html>
<html>
<head>
  <title><%= title %></title>
  <link rel="stylesheet" href="/styles.css">
  <script>
    (() => {
      if (localStorage.getItem("theme") === "dark") {
        document.documentElement.classList.add("dark");
      }
    })();
  </script>
</head>

<body>
  <div class="board-container">
    <button id="mode-toggle" class="mode-toggle">ðŸŒ™</button>

    <ul class="messages">
      <% messages.forEach((msg, i) => { %>
        <li class="message-item">
          <div
            class="avatar"
            style="background-color: <%= avatarColors[Math.abs(msg.user.charCodeAt(0)) % avatarColors.length] %>;">
            <%= msg.user.charAt(0).toUpperCase() %>
          </div>

          <div class="message-content">
            <p class="user"><%= msg.user %></p>
            <p class="text"><%= msg.text %></p>
            <p class="timestamp">
              <%= msg.added.toLocaleString("en-US", {
                  month: "short", day: "numeric", year: "numeric",
                  hour: "2-digit", minute: "2-digit"
              }) %>
            </p>
          </div>
        </li>
      <% }) %>
    </ul>
  </div>

  <a href="/new" class="floating-button">Send message</a>
  <script src="/theme.js"></script>
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const msgList = document.querySelector(".messages");
      if (msgList) {
        msgList.scrollTop = msgList.scrollHeight;
      }
    });
  </script>

</body>
</html>
